<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="流浪貓咪認養平台，提供公立收容所貓咪資料(資料來源:農委會opendata)，以及收容所聯絡方式，歡迎參考貓咪資訊後，直接聯繫收容所進行認養" name="description">
  <meta content="cat adoption, 貓咪領養, 流浪貓, 流浪動物之家" name="keywords">
  <title>領我回家 Take me home | 流浪貓認養平台</title>
  <!-- Favicons -->
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css"> -->
  <link rel="stylesheet" href="plugin/owlcarousel/assets/owl.carousel.min.css">
  <link rel="stylesheet" href="plugin/owlcarousel/assets/owl.theme.default.min.css">
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css">
  <link rel="stylesheet" href="css/custom.css">
  
  <!-- script -->
  <script src="plugin/jquery-3.5.1.min.js"></script>
  <script src="plugin/jquery.easing.min.js"></script>
  <script src="plugin/owlcarousel/owl.carousel.min.js"></script>
  <script src="plugin/typed.js"></script>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y10Y0E0PG5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-Y10Y0E0PG5');
  </script>
</head>

<body>
  <script> // init AOS.js
    AOS.init();
  </script>
  <header>
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-baseline align-items-md-center py-2 px-3 px-lg-5 fixed-top" id="header">
      <div class="d-flex justify-content-between" id="topbarnd">
        <a href="index.html" class="brand d-flex align-items-start align-items-md-center">
          <img src="img/00cat-256.png" width="50px" alt="logo" class="p-2">
          <span class="m-0 py-2 font-weight-bold c-g-4">領我回家 <span class="c-p-5">Take</span><span class="c-p-8">Me</span><span class="c-p-5">Home</span></span>
        </a>
        <!-- 利用class 變形導航icon 三 => X -->
        <div class="d-flex d-md-none" aria-label="切換導航欄" id="nav-toggle">
          <div class="toggle-line-1"></div>
          <div class="toggle-line-2"></div>
          <div class="toggle-line-3"></div>
        </div>  
      </div>
      <ul class="nav flex-column flex-md-row justify-content-md-end">
        <li class="nav-item">
          <a class="nav-link" href="index.html">回首頁</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#cats">最新收容貓咪</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#shelter">收容所資訊</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#contact">聯絡站長</a>
        </li>
      </ul>
    </div>
  </header>
  <main>
    <section id="banner">
      <div class="container py-3">
        <div class="row justify-content-center my-3 topic" data-aos="flip-up" data-aos-duration="1200">
          <span>浪貓認養平台</span> 
        </div>
        <div class="row justify-content-center mb-2">
          <div class="col-12 col-sm-10 col-md-8 col-lg-6 col-xl-5 c-r-1 font-weight-bold typed1">
          </div>
        </div>
        <script> // typed.js  for banner slogan
          //  打字效果 https://github.com/mattboldt/typed.js/ 
            new Typed('.typed1', {
              strings: ['你在等我嗎？^1500 我在這裡期待給你溫暖的陪伴~ &hearts; ^4000 '],
              loop: true,
              typeSpeed: 20,
              backSpeed: 0,
              backDelay: 0,
              showCursor: false,
              fadeIn:true,
              fadeOut: true,
              fadeOutClass: 'typed-fade-out',
              fadeOutDelay: 1000,
            });
        </script>
        <div class="row justify-content-center">
          <div class="owl-carousel owl-theme">
            <div class="item"><img src="img/banner/01.JPG" alt="cat pic"></div>
            <div class="item"><img src="img/banner/02.jpeg" alt="cat pic"></div>
            <div class="item"><img src="img/banner/03.JPG" alt="cat pic"></div>
            <div class="item"><img src="img/banner/04.jpg" alt="cat pic"></div>
            <div class="item"><img src="img/banner/05.jpg" alt="cat pic"></div>
            <div class="item"><img src="img/banner/06.JPG" alt="cat pic"></div>
          </div>
        </div>
      </div>
    </section>
    <script> // owl carousel   for banner
      $('.owl-carousel').owlCarousel({
          center: true,
          items:1,
          loop:true,
          dots:true,
          autoplay:true,
      });
    </script>
    <section id="cats">
      <div class="container py-3">
        <div class="row justify-content-center my-3 topic" data-aos="flip-up" data-aos-duration="1200">
          <div class="box-1"></div>
          <div class="box-2"></div>
          <span>最新收容貓咪</span> 
        </div>
        <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 row-cols-xl-4" id="newCats">
          <!-- 主要card code -->
        </div>
          <!-- 抓取API資料 -->
        <script> // 網頁開啟時先抓8筆資料，生成card，後續擴充功能，隨滑鼠滾動load更多資料，或點擊獲得更多
          let nw = new Date();
          let nwDate = nw.getDate();
          
          let qtyCatCard=$("#newCats").children().length;

          let uCatCard=$("#newCats").children().find("div.card:hidden").length
          let vCatCard=0;
          let stCard=0;
          let page=1;

          function padLeft(num) { // 補0 至num位
            return num.toString().padStart(2, '0');
          }

          function newCatCard(qty) { // 一次生成 qty 貓咪卡片，且顯示從 page*12 張的qty卡片 (取1,2,3,4最小公倍數)
            let newD=new Date(new Date().setDate(nwDate))
            let 
              newYear = newD.getFullYear(),
              newMonth = newD.getMonth()+1,
              newDate = newD.getDate();
            console.log(newD)
            let Mn = padLeft(newMonth); // 從最新的month開始抓資料
            let Dt = padLeft(newDate); // 從最新的date開始抓資料
            $.ajax({
              url: "api/api_CURL.php",
              method: "get",
              data: {
                "top":100,
                "skip":0,
                // "skip":0+100*(page-1),
                "animal_createtime":newYear+"/"+Mn+"/"+Dt,},
              dataType: "json",
              success: function(re){
                if (re.length == 0) {
                  console.log(newYear+"/"+Mn+"/"+Dt,"no data")
                  nwDate--; // 從最近的日期沒資料，就往前一天抓
                  newCatCard(qty);
                } else {
                  // console.log(re)
                  re.forEach(e => {
                    if(e.album_file!=""){ // 只抓 有照片 的資料
                      qtyCatCard++;
                      if (e.animal_age=="ADULT") e.animal_age='成貓';
                      if (e.animal_age=="CHILD") e.animal_age='幼貓';
                      if (e.animal_sex=="F") e.animal_sex="母";
                      if (e.animal_sex=="M") e.animal_sex="公";
                      if (e.animal_sex=="N") e.animal_sex="(?)";
                      html=`<div class="col mb-4" style="display:none">
                              <div class="card" onclick="addCatModal(${e.animal_id})" data-toggle="modal" data-target="#Modal${e.animal_id}">
                                <img src="${e.album_file}" class="card-img-top">
                                <div class="card-body">
                                  <div class="card-title"><span class="h5 font-weight-bold">${e.animal_colour.substr(0,3)}${e.animal_sex}${e.animal_kind}</span><span class="text-warning">${e.animal_age} ${e.animal_id}</span></div>
                                  <p class="card-text">發現地點：<span>${e.animal_foundplace.substr(0,6)}...</span></p>
                                  <p class="card-text">目前位置：<span>${e.shelter_name.substr(0,6)}...</span></p>
                                  <p class="card-text">資料建立時間：<span>${e.animal_createtime}</span></p>
                                </div>
                              </div>
                            </div>`;
                      $(html).appendTo('#newCats');
                      console.log(e.animal_id,e.animal_createtime,qtyCatCard);
                    }
                    else{
                      console.log(e.animal_id,"no pic",qtyCatCard);
                    }
                  })
                  if(qtyCatCard<(qty+(page-1)*12)){
                    nwDate--;
                    newCatCard(qty)
                  }
                }
              }
            }).then(()=>{
              showCatCard()
              vCatCard=$("#newCats").children().find("div.card:visible").length
              console.log(`show ${page}*12 cards`,vCatCard)
            })
          }

          function showCatCard(){  // 訂每個page為12 張卡片 (取1,2,3,4最小公倍數)
            let p=page*12, t=(page-1)*12;
            for (let i = t; i < p; i++) {
                $("#newCats").children().eq(i).fadeIn(1000);
            }
          }

          function addCatCard(qty){
            nwDate--;
            page++;
            newCatCard(qty)
          }

          newCatCard(12); 
        </script>
        <div class="row justify-content-center align-items-center" id="catModal">
          <!-- Modal -->
        </div>        
        <!-- Modal彈出內容  -->
        <script> // 點擊card 出現貓咪細節資料 modal應用
          function addCatModal(id){
            let url =`https://agridata.coa.gov.tw/api/v1/AnimalRecognition/?animal_id=${id}&%24top=1000&Page=1`;
            let remark="";
            $.getJSON(url)
            .done((re)=>{
              console.log(re.Data[0]);
              let e=re.Data[0];
              if (e.animal_remark!=""){remark=`<p class="p2 font-weight-bold text-danger">${e.animal_remark}</p>`};
              if (e.animal_bodytype=="SMALL") e.animal_bodytype='小型';
              if (e.animal_bodytype=="MEDIUM") e.animal_bodytype='中型';
              if (e.animal_age=="ADULT") e.animal_age='成貓';
              if (e.animal_age=="CHILD") e.animal_age='幼貓';
              if (e.animal_sex=="F") e.animal_sex="母";
              if (e.animal_sex=="M") e.animal_sex="公";
              if (e.animal_sex=="N") e.animal_sex="(不確定性別)";
              if (e.animal_opendate=="") e.animal_opendate="待開放"
              switch(e.animal_bacterin){
                case "T": e.animal_bacterin="已接種"
                  break;
                case "F": e.animal_bacterin="尚未接種"
                  break;
                case "N": e.animal_bacterin="待確認"
                  break;
              }
              let html=
                `<div class="modal fade" id="Modal${id}" tabindex="-1" role="dialog" aria-labelledby="ModalLabel${id}" aria-hidden="true" style="padding-right:0">
                  <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                      <div class="modal-header text-center">
                        <div class="modal-title" id="ModalLabel${id}">
                          <div class="d-inline-block font-weight-bold h4 m-0 c-o-1">${e.animal_colour}${e.animal_sex}${e.animal_kind}</div>&nbsp&nbsp&nbsp&nbsp
                          <div class="d-inline-block c-o-2">${e.animal_bodytype}${e.animal_age}</div>
                        </div>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <div class="modal-body">
                        <img class="card-img" src="${e.album_file}">
                        <p class="p0">ID:${e.animal_id}</p>
                        <p class="p1">發現地點：${e.animal_foundplace}</p>
                        ${remark}
                      </div>
                      <div class="modal-footer d-flex flex-column align-items-start">
                        <div>目前位置：<span class="font-weight-bold">${e.shelter_name}</span></div>
                        <div>地址：<span class="font-weight-bold">${e.shelter_address}</span></div>
                        <div>電話：<span class="font-weight-bold">${e.shelter_tel}</span></div>
                        <div>狂犬病疫苗：${e.animal_bacterin}</div>
                        <div>開放認養日：${e.animal_opendate}</div>
                      </div>
                    </div>
                  </div>
                </div>`;
              $(html).appendTo("#catModal");
              $(`#Modal${id}`).modal('show')
            })
            .fail(()=>{alert("資料來源異常，無法正常取得資料")})
            }
        </script>
        <div class="row justify-content-center">
          <div data-aos="fade-up" data-aos-offset="500" data-aos-easing="ease-in-sine" class="c-r-1 font-weight-bold" id="moreCats" onclick="addCatCard(12)">更多貓咪</div>
        </div>
      </div>
    </section>
    <section id="shelter">
      <div class="container py-3">
        <div class="row justify-content-center my-3 topic" data-aos="flip-up" data-aos-duration="1200">
          <span>收容所資訊</span> 
        </div>
        <div class="row flex-column align-items-center justify-content-center">
          <p>...資料建立中... </p>
          <p>1. 使用select選擇區域後，利用ajax取得該區域收容所清單 <br>2. 選取查詢的收容所，自動帶入地圖和聯絡細節，並可撥打電話</p>
        </div>
        <form class="row justify-content-center py-3">
          <div class="input-group col-12 col-sm-5 col-lg-4">
            <div class="input-group-prepend">
              <label class="input-group-text" for="area">區域</label>
            </div>
            <select class="custom-select" name="area" id="area">
              <option value="">查詢區域</option>
              <option value="1">北部</option>
              <option value="2">中部</option>
              <option value="3">南部</option>
              <option value="4">東部</option>
              <option value="5">離島</option>
            </select>
          </div>
          <div class="input-group col-12 col-sm-7 col-lg-5">
            <div class="input-group-prepend">
              <label class="input-group-text" for="area">收容所</label>
            </div>
            <select class="custom-select" name="area" id="shelter_name">
              <option value="">欲查詢收容所名稱</option>
            </select>
          </div>
        <script>
          $("select").change(function (e) { 
            e.preventDefault();
            let t=$(this).find(":selected").text()
            let v=$(this).find(":selected").val()
            console.log(t,v)
          });

        </script>
        </form>
        <div class="row justify-content-center align-items-stretch">
          <div class="col-12 col-sm-5 col-lg-4">
            <div class="row justify-content-center my-1 shelterT" data-aos="fade-right" data-aos-duration="1200">
              <span>臺北市動物之家</span> 
            </div>
            <img src="img/191108015455504825ZD8JJ.jpg" width="100%">
            <table class="my-3 c-o-2">
              <tr>
                <td style="width: 30%;">地址</td>
                <td style="width: 70%;">臺北市內湖區潭美街852號</td>
              </tr>
              <tr>
                <td>電話</td>
                <td><a href="tel:+886287913254">02-87913254</a><br><a href="tel:+886287913255">02-87913255</a></td>
              </tr>
              <tr>
                <td>參觀時間</td>
                <td>週二至週日 上午10:00~12:30 下午1:30~4:00</td>
              </tr>
            </table>
          </div>
          <!-- <div class="col-12 col-sm-7 col-lg-5"> -->
            <iframe  class="col-12 col-sm-7 col-lg-5" src="https://www.google.com/maps/embed?pb=!1m10!1m8!1m3!1d115731.24512111208!2d121.50793946811967!3d24.979672412647325!3m2!1i1024!2i768!4f13.1!5e0!3m2!1szh-TW!2stw!4v1611573299478!5m2!1szh-TW!2stw" width="600" height="450" frameborder="0" style="border:0;" allowfullscreen="" aria-hidden="false" tabindex="0"></iframe>
          <!-- </div> -->
        </div>
      </div>
    </section>


    <section id="contact">
      <div class="container py-3">
        <div class="row justify-content-center my-3 topic" data-aos="flip-up" data-aos-duration="1200">
          <span>聯絡站長</span> 
        </div>
        <div class="row justify-content-center">...資料建立中...</div>
        <div class="row justify-content-center">
          <div class="social d-flex p-2 justify-content-between">
            <a href="https://github.com/MissPigHead"><i class="fab fa-github"></i></a>
            <a href="https://www.linkedin.com/in/lmisspighead/"><i class="fab fa-linkedin"></i></a>
            <a href="https://codepen.io/misspighead"><i class="fab fa-codepen"></i></a>
            <a href="https://www.facebook.com/MissPigHead"><i class="fab fa-facebook"></i></a>
          </div>
        </div>
        <div class="row justify-content-center py-3">
          <div class="col-10">
            節錄自《行路遠方，與貓相愛的練習曲：一個貓痴攝影師橫跨歐、亞、非，繞地球兩圈半的追貓紀行》
            <p>◎人貓和平相處、共生共享；貓療癒了我們，我們更要盡心照顧貓</p>
            <p>躺在遊人腿上呼嚕嚕的瞌睡貓、亦步亦趨守護著不良於行的老人的侍衛貓、擠到奶奶面前和小孫女爭寵的撒嬌貓……作者遊歷了30多座城市，見證許多人貓共處的感動時刻，那些街貓為嚴肅生活帶來暖意，除了溫飽，牠們更多時候需要人類關愛的觸撫。</p>
            <p>◆「喵喵喵，Coffee、tea or me？」圓呼呼的小毛球，是招攬生意的小幫手</p>
            <p>日本福岡中洲的冰淇淋小店，貓店長正親切地招呼客人：「來買冰淇淋喔！喵喵喵！」臺灣淡水「有河Book」的慵懶貓、吃完飯就快閃的速食貓，吸引許多愛貓、愛書人前去朝聖；猴硐「217咖啡館」更有超人氣模特兒貓，可愛模樣讓人情不自禁走進店家，攬客技術一流！</p>
            <p>◆「我們今天吃什麼？」世界各地的街貓，都要感謝貓老爹、貓老媽</p>
            <p>無論在哪裡，都有不畏風雨、定時定點餵食貓族的貓老爹、貓老媽，就算拖著行動不便的身軀，他們也堅持貓和人一樣不能挨餓，並為牠們建造遮風避雨的住所，甚至霸氣地向路人申明對街貓的「所有權」──這一切都是出自對流浪動物一份關懷的愛。</p>
          </div>
        </div>
        <div class="row justify-content-center py-3">
          <div class="col-10">
            註明如此觀看朋友變化大力如此黑色一看攻擊開展心中，說過態度不是很衛生不出賺錢上次機制剛才小遊戲網易，遊客保險真是預測令人，商城不可能交給之下不能下載，大多數人間精選對方處理未來場所，現有快速適用農村無奈能夠，積分榮譽廠商結束作家當地感謝一笑，真正對話，當。
          </div>
        </div>
      </div>
    </section>
  </main>
  <footer>
    <div class="d-flex flex-column flex-sm-row justify-content-center justify-content-sm-between align-items-center px-4 py-2" id="footer">
        <div>
          <div class="d-flex align-items-center">
            <img src="img/00cat-256.png" width="35px" alt="logo" class="p-2">
            <span class="m-0 py-2 font-weight-bold c-g-4">領我回家 <span class="c-p-5">Take</span><span class="c-p-8">Me</span><span class="c-p-5">Home</span></span>
          </div>  
        </div>
        <div class="d-flex flex-column align-items-center align-items-sm-end">
          <p class="col text-center text-sm-right">資料來源:行政院農委會 | 最後更新:2021/2/17</p>
          <p class="col">&copy; 2020 &nbsp;<strong>Lingling Chang</strong>. All rights reserved.</p>
        </div>
    </div>
    <div id="scrolltop" class="position-fixed shown">
      <a class="d-inline-block" href="#"><i class="fas fa-angle-double-up fa-2x"></i></a>
    </div>
  </footer>

  <script> 
    // 控制導覽列 寬螢幕在上方，小螢幕縮為toggle
    $("#nav-toggle").on("click",(event)=>{
      var item = event.currentTarget;
      // console.log("OOO")
      $(".nav").toggle();
      if (item.classList.contains("act")){
        $("#nav-toggle").removeClass("act")
        $(".toggle-line-2").toggle().fadeIn();
        $(".toggle-line-1").removeClass("toggle-line-first")
        $(".toggle-line-3").removeClass("toggle-line-last")
      }
      else{
        // console.log("XXX")
        $("#nav-toggle").addClass("act")
        $(".toggle-line-2").toggle();
        $(".toggle-line-1").addClass("toggle-line-first")
        $(".toggle-line-3").addClass("toggle-line-last")
      }
      mainMargin()
    })
  
    // 隨header高度，調整main的位置
    function mainMargin(){
      $("main").css("margin-top",$("#header").outerHeight(true))
    }
    
    function debounce(fn, wait) {
      var timeout = null;
      return function() {
        if(timeout !== null)
        clearTimeout(timeout);
        timeout = setTimeout(fn, wait);
      }
    }
    window.addEventListener('resize', debounce(mainMargin, 100));
    mainMargin()

    // 下方回首頁的提示 跳跳icon 要執行跳回去的高度 + icon顯示控制
    function goTop() {
      let
        nowat = $(window).scrollTop(),
        height=$("#header").innerHeight()+$("#banner").innerHeight()-100;
      // console.log(nowat,height)
      if (nowat <= height) {
        $("#scrolltop").removeClass("shown");
      } else {
        $("#scrolltop").addClass("shown");
      }
    }

    // 跳至指定#時 移動效果+高度控制
    $("#header a, #scrolltop a").click(function () {
      let who = $(this).attr("href");
      if (who=="#"){who="#banner"}
      let val = $(who).offset().top - $("#header").innerHeight() + 1;
      // console.log(who,val)
      
      $("html").animate(
        { scrollTop: val }, 1000, "swing"
      );
    });

    $(window).scroll(() => {
      goTop(); // bounce to top
      spy(); // scroll spy
    });

    function spy() {
      let nowat = $(window).scrollTop();
      $('section').each(function () {
        let
          id = $(this).attr('id'),
          offset = $(this).offset().top - $("#banner").innerHeight(),
          height = $(this).innerHeight();
          console.log(id,nowat,offset,height)
        if (offset <= nowat && nowat < offset + height) {
          $("#header a").removeClass('active');
          $(`#header a[href='#${id}']`).addClass('active');
        };
      });
    }

  </script>
</body>
</html>